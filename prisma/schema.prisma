generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Category {
  id              Int        @id @default(autoincrement())
  name            String
  description     String?
  parent_id       Int?
  parent_category Category?  @relation("category_parent", fields: [parent_id], references: [id])
  children        Category[] @relation("category_parent")
  position        Int?
  created_at      DateTime   @default(now())
  updated_at      DateTime   @updatedAt

  brands           Category_brand[]
  attribute_groups Attribute_Group[]
  products         Product[]
}

model Brand {
  id          Int      @id @default(autoincrement())
  name        String
  description String
  position    Int
  logo_url    String
  created_at  DateTime @default(now())
  updated_at  DateTime @updatedAt

  categories Category_brand[]
  products   Product[]
}

model Product_model {
  id          Int      @id @default(autoincrement())
  name        String
  description String
  brand_id    Int
  created_at  DateTime @default(now())
  updated_at  DateTime @updatedAt

  category_brand Category_brand? @relation(fields: [brand_id], references: [id])
  products       Product[]
}

model Category_brand {
  id          Int      @id @default(autoincrement())
  category_id Int?
  brand_id    Int?
  created_at  DateTime @default(now())

  brand    Brand?    @relation(fields: [brand_id], references: [id])
  category Category? @relation(fields: [category_id], references: [id])

  product_models Product_model[]
  sale_models    Sale_model[]
}

model Attribute_Group {
  id          Int      @id @default(autoincrement())
  name        String
  position    Int?     @default(1)
  category_id Int
  created_at  DateTime @default(now())
  updated_at  DateTime @updatedAt

  category   Category?   @relation(fields: [category_id], references: [id])
  attributes Attribute[]
}

model Attribute {
  id                 Int      @id @default(autoincrement())
  name               String
  position           Int?     @default(1)
  attribute_group_id Int
  created_at         DateTime @default(now())
  updated_at         DateTime @updatedAt

  attribute_group Attribute_Group? @relation(fields: [attribute_group_id], references: [id])
  product_info    Product_Info[]
}

model Product_Info {
  id           Int     @id @default(autoincrement())
  product_id   Int
  attribute_id Int
  value        String
  show_in_main Boolean @default(false)

  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  product   Product?   @relation(fields: [product_id], references: [id])
  attribute Attribute? @relation(fields: [attribute_id], references: [id])
}

model Views {
  id         Int      @id @default(autoincrement())
  user_id    Int
  product_id Int
  liked      Boolean  @default(false)
  view_date  DateTime @default(now())

  product Product? @relation(fields: [product_id], references: [id])
}

model Payment {
  id             Int      @id @default(autoincrement())
  user_id        Int
  order_id       Int
  payment_date   DateTime @default(now())
  totalAmount    Int
  payment_method String
  payment_status String

  order Orders? @relation(fields: [order_id], references: [id])
  user  User?   @relation(fields: [user_id], references: [id])
}

model Comment {
  id         Int      @id @default(autoincrement())
  user_id    Int
  product_id Int
  comment    String
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  user    User?    @relation(fields: [user_id], references: [id])
  product Product? @relation(fields: [product_id], references: [id])
}

model User {
  id         Int      @id @default(autoincrement())
  first_name String
  last_name  String
  phone      String
  password   String
  token      String
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  user_addresses User_address[]
  payments       Payment[]
  orders         Orders[]
  comments       Comment[]
  ratings        Rating[]
}

model Admin {
  id         Int      @id @default(autoincrement())
  first_name String
  last_name  String
  phone      String
  password   String
  token      String
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
}

model User_address {
  id         Int @id @default(autoincrement())
  user_id    Int
  address_id Int

  user    User?    @relation(fields: [user_id], references: [id])
  address Address? @relation(fields: [address_id], references: [id])
}

model Orders {
  id           Int      @id @default(autoincrement())
  user_id      Int
  address_id   Int
  full_name    String
  phone_number String
  status       String
  created_at   DateTime @default(now())
  updated_at   DateTime @updatedAt

  user        User?         @relation(fields: [user_id], references: [id])
  address     Address?      @relation(fields: [address_id], references: [id])
  Order_items Order_items[]
  payment     Payment[]
}

model Order_items {
  id         Int      @id @default(autoincrement())
  order_id   Int
  product_id Int
  quantity   Int
  subtotal   Int
  created_at DateTime @default(now())

  order   Orders?  @relation(fields: [order_id], references: [id])
  product Product? @relation(fields: [product_id], references: [id])
}

model Product {
  id               Int      @id @default(autoincrement())
  category_id      Int
  brand_id         Int
  product_model_id Int
  description      String
  price            Int
  count            Int
  created_at       DateTime @default(now())
  updated_at       DateTime @updatedAt

  category      Category?      @relation(fields: [category_id], references: [id])
  brand         Brand?         @relation(fields: [brand_id], references: [id])
  product_model Product_model? @relation(fields: [product_model_id], references: [id])

  product_info  Product_Info[]
  product_media Product_media[]
  cart_items    Cart_items[]
  order_items   Order_items[]
  comments      Comment[]
  ratings       Rating[]
  views         Views[]
}

model Product_media {
  id         Int    @id @default(autoincrement())
  product_id Int
  url        String
  type       String

  product Product? @relation(fields: [product_id], references: [id])
}

model Cart_items {
  id         Int      @id @default(autoincrement())
  user_id    String
  product_id Int
  quantity   Int
  subtotal   Int
  created_at DateTime @default(now())

  product Product? @relation(fields: [product_id], references: [id])
}

model Sale {
  id         Int      @id @default(autoincrement())
  start_date String
  end_date   String
  percent    Int?
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  sales Sale_model[]
}

model Sale_model {
  id       Int  @id @default(autoincrement())
  model_id Int?
  sale_id  Int?

  sale Sale? @relation(fields: [sale_id], references: [id])

  model Category_brand? @relation(fields: [model_id], references: [id])
}

model Position {
  id                          Int      @id @default(1)
  brand_positioning           Int[]
  attribute_positioning       Int[]
  category_positioning        Int[]
  attribute_group_positioning Int[]
  createdAt                   DateTime @default(now()) @map("created_at")
  updatedAt                   DateTime @updatedAt @map("updated_at")
}

// Rating

model Rating {
  id         Int @id @default(autoincrement())
  rating     Int
  user_id    Int
  product_id Int

  user    User?    @relation(fields: [user_id], references: [id])
  product Product? @relation(fields: [product_id], references: [id])
}

model Address {
  id          Int    @id @default(autoincrement())
  location    String
  street      String
  district_id Int?

  district District? @relation(fields: [district_id], references: [id])

  updated_at DateTime @updatedAt
  created_at DateTime @default(now())

  order          Orders[]
  user_addresses User_address[]
}

model District {
  id        Int    @id @default(autoincrement())
  name      String @unique
  parent_id Int?

  addresses Address[]

  parent    District?  @relation("districts_child", fields: [parent_id], references: [id])
  districts District[] @relation("districts_child")
}

// Shu yerda sizga berilgan modellarning yarating
